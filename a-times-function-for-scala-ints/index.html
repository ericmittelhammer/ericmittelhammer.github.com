<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>A "times" function for Scala Ints</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

        <link rel="stylesheet" href="/css/normalize.css">
        <link rel="stylesheet" href="/css/main.css">
        <link rel="stylesheet" href="/css/font-awesome.min.css">
        <link href='http://fonts.googleapis.com/css?family=Lato:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="http://yandex.st/highlightjs/7.3/styles/sunburst.min.css">
        <link rel="stylesheet" href="/css/site.css">
        <script src="http://yandex.st/highlightjs/7.3/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <script src="js/vendor/modernizr-2.6.2.min.js"></script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->
        <div id="main">
            <header id="global">
                <a href="/" id="blog-title">Eric Mittelhammer</a>
                <p class="about">Software guy doing software things.</p>
                <ul id="social">
                    <li><script type="text/javascript">
                    document.write("<a href=\"mail" + "to:" + new Array("blog","ericmittelhammer.com").join("@") + "\">" + "<i class=\"icon-envelope-alt\"></i>" + "</" + "a>");
                </script></li>
                <li><a href="http://twitter.com/emittelhammer"><i class="icon-twitter"></i></a></li>
                <li><a href="https://github.com/ericmittelhammer"><i class="icon-github"></i></a></li>
            </ul>
            </header>   
            <div class="content">
            <!-- Add your site or application content here -->
              <div id="post">
  	<div class="post-content">
	    <h1 class="post-title">A "times" function for Scala Ints</h1>
	    <hr/>
	    <p><p>Unlike Ruby, Scala lacks a "times" looping construct.  Given the language's myriad iteration methods, you may deem such a thing superfluous.  But that doesn't mean it still isn't fun to tell some Ruby fanboi to STFU!  With Scala's implicit conversions, you are armed with the tools to do just that.</p>

<!--more-->


<p>Ah, implicits.  Scala's secret ingredient in the <a href="http://www.artima.com/weblogs/viewpost.jsp?thread=179766">library-pimping</a> sauce.  Part sorcery, part FP nerd-fu.  Some say they make code hard to read, but they let you teach old classes new tricks. And teach we shall.</p>

<p>Do this:</p>

<pre><code class="scala">class IntWithTimesFunction(limit: Int) {
    def times(f: => Any): Unit = for (i <- 0 until limit) f
}
object IntWithTimesFunction {
    implicit def convertIntToIwtf(i: Int) = new IntWithTimesFunction(i)
}
</code></pre>


<p>Take a look at the IntWithTimesFunction companion object.  See that implicit def?  If the compiler encounters a type mismatch, it will check the current import scope for an implicitly defined function that takes the "bad" type as its only parameter and returns an instance of the "good" type.  If it can find one, it will use it to convert the object to the correct type.</p>

<p>So while you normally can't do this:</p>

<pre><code class="scala">scala&gt; val i = 5
i: Int = 5

scala&gt; i.times
<console>:9: error: value times is not a member of Int
              i.times</code></pre>


<p>Behold the magic of implicit conversions:</p>

<pre><code class="scala">scala&gt; import IntWithTimesFunction._
import IntWithTimesFunction._

scala&gt; 5 times println("goop")
goop
goop
goop
goop
goop
</code></pre>


<p>Get it?</p>

<p>Here's how the times function works:</p>

<pre><code class="scala">def times(f: => Any): Unit = for (i <- 0 until limit) f</code></pre>


<p>See the parameter list for the function?  Slighty strange notation.  This is Scala's call-by-name paradigm.  It causes any expression that appears as a function argument to be evaluated at the time its used within the function, where normally it would be evaluated first and its <em>result</em> passed into the function.
So given the signature above, every time "f" appears in the "times" function - whatever was passed as that argument will be evaluated again.</p>

<p>Now we'll add a function to IntWithTimesFunction that provides access to the loop index:</p>

<pre><code class="scala">class IntWithTimesFunction(limit: Int) {
    def times(f: => Any): Unit = for (i <- 0 until limit) f
    def timesWithIndex(f: Int => Unit): Unit = 0 until limit foreach f
}</code></pre>


<p>Slighty different here.  This one takes another function as a parameter which itself must take a single Int (the loop index) as a parameter.  The <a href="http://www.scala-lang.org/api/current/index.html#scala.collection.immutable.Range">foreach function</a> will pass the current element in the range into function f, like so:</p>

<pre><code class="scala">scala> 5 timesWithIndex (x => println(x + 3) )
3
4
5
6
7</code></pre>


<p>So, Scala devs, don't let those Ruby dudes push you around any longer!  With just a bit of functional magic your language can be just as unnecessarily verbose.</p>
</p>
	</div>
  </div>

            </div>
        </div>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.8.3.min.js"><\/script>')</script>
        <script src="js/plugins.js"></script>
        <script src="js/main.js"></script>

        <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
        <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-25868864-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

        </script>
    </body>
</html>
